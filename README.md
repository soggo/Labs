This is spaghetti code for now due to my technical limitations and the need to meet a deadline, will refactor in future